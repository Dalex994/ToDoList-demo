<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Damien Laville">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo App</title>
    <link rel="stylesheet" href="styles.css">

    <script>
        let tasksList = [];

        let listePriorites = [{"idPriorite":1,"priorite":"Urgent"},{"idPriorite":2,"priorite":"Très Important"},{"idPriorite":3,"priorite":"Important"},{"idPriorite":4,"priorite":"Ordinaire"},{"idPriorite":5,"priorite":"Futile"}];
        let listeTemps = [{"idTemps":1,"temps":"Instantané"},{"idTemps":2,"temps":"Rapide"},{"idTemps":3,"temps":"Moyen"},{"idTemps":4,"temps":"Long"},{"idTemps":5,"temps":"Très Long"}];
        let listeCategories = [{"idCategorie": 1,"categorie":"Travail"},{"idCategorie": 2,"categorie":"Études"},{"idCategorie": 3,"categorie":"Loisirs"},{"idCategorie": 4,"categorie":"Famille"},{"idCategorie": 5,"categorie":"Personnel"}];
        let listeDifficultes = [{"idDifficulte": 1,"difficulte":"Trèès Facile"},{"idDifficulte": 2,"difficulte":"Tranquille"},{"idDifficulte": 3,"difficulte":"Moyen"},{"idDifficulte": 4,"difficulte":"Difficile"},{"idDifficulte": 5,"difficulte":"Inabordable"}];

        function save() {
            let dataString = localStorage.getItem("tasks");

            if (dataString != null)
                tasksList = JSON.parse(dataString);

            let contenu = document.getElementById("title").value;
            let priorite = document.getElementById("idPriorite").value;
            let temps = document.getElementById("idTemps").value;
            let categorie = document.getElementById("idCategorie").value;
            let difficulte = document.getElementById("idDifficulte").value;
            let date = document.getElementById("dateLimite").value;

            let newIdTask = tasksList.length + 1;
            let newTask = {
                "idTache": newIdTask,
                "Tache": contenu,
                "idPriorite": parseInt(priorite),
                "idTemps": parseInt(temps),
                "idCategorie": parseInt(categorie),
                "idDifficulte": parseInt(difficulte),
                "dateLimite": date
            };
            tasksList.push(newTask);
            let tasksListString = JSON.stringify(tasksList);
            localStorage.setItem("tasks", tasksListString);
            console.log(newTask);

            document.getElementById("tachesForm").reset();
        }
    </script>


</head>
<body>

<h1>TooDid</h1>

<form id="tachesForm">
    <input type="text" placeholder="Titre" id="title" required>

    <label for="idPriorite">Priorité</label>
    <select name="priorite" id="idPriorite" required>
        <option value="" selected> Choisir</option>
    </select>
    <script>
        listePriorites.forEach(function (item, index) {
            let option = `<option value="${item.idPriorite}">${item.priorite}</option>`;
            document.getElementById("idPriorite").insertAdjacentHTML('beforeend', option);
        });
    </script>


    <label for="idTemps">Temps</label>
    <select name="temps" id="idTemps" required>
        <option value="" selected> Choisir</option>
    </select>
    <script>
        listeTemps.forEach(function (item, index) {
            let option = `<option value="${item.idTemps}">${item.temps}</option>`;
            document.getElementById("idTemps").insertAdjacentHTML('beforeend', option);
        });
    </script>


    <label for="idCategorie">Catégorie</label>
    <select name="categorie" id="idCategorie" required>
        <option value="" selected> Choisir</option>
    </select>
    <script>
        listeCategories.forEach(function (item, index) {
            let option = `<option value="${item.idCategorie}">${item.categorie}</option>`;
            document.getElementById("idCategorie").insertAdjacentHTML('beforeend', option);
        });
    </script>


    <label for="idDifficulte">Difficulté</label>
    <select name="difficulte" id="idDifficulte" required>
        <option value="" selected> Choisir</option>
    </select>
    <script>
        listeDifficultes.forEach(function (item, index) {
            let option = `<option value="${item.idDifficulte}">${item.difficulte}</option>`;
            document.getElementById("idDifficulte").insertAdjacentHTML('beforeend', option);
        });
    </script>


    <label for="dateLimite">Date limite !</label>
    <input id="dateLimite" type="date" value="" required>

    <button type="button" onclick="save()">Enregistrer</button>
</form>

<a href="Table/table.html" target="_blank" id="sommaireBtn"><button type="button">Sommaire</button></a>

<footer>Damien Laville, 2025 @ Copyright</footer>

</body>
</html>